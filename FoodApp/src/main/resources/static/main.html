<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>충청북도 음식점</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

<div class="container py-5" id="app">
    <!-- 검색 영역 -->
    <div class="card mb-4">
        <div class="card-body">
            <form class="row g-3">
                <div class="col-md-8">
                    <input type="text" class="form-control" placeholder="검색어 입력">
                </div>
                <div class="col-md-2">
                    <button type="button" class="btn btn-primary w-100" @click="getList()">검색</button>
                </div>
                <div class="col-md-2 d-flex align-items-center">
                    <span class="fw-bold text-secondary small">총 {{count}}건</span>
                </div>
            </form>
        </div>
    </div>

    <!-- 테이블 -->
    <div class="card">
        <div class="card-header fw-bold">
            검색 결과
        </div>
        <div class="table-responsive">
            <table class="table table-hover table-bordered align-middle text-center mb-0">
                <thead class="table-light">
                    <tr>
                        <th>시군</th>
                        <th>상호명</th>
                        <th>전화번호</th>
                        <th>주소</th>
                        <th>메인 메뉴</th>
                        <th>이동</th>
                    </tr>
                </thead>
                <tbody>
                    <tr v-for="store in storeList">
                        <td>{{store.SIGUN}}</td>
                        <td>{{store.CMPNM}}</td>
                        <td>{{store.TELNO}}</td>
                        <td>{{store.ADRES}}</td>
                        <td>{{store.MNMNU}}</td>
                        <td>
                            <a :href="store._URL" target="_blank" class="btn btn-outline-primary btn-sm">보기</a>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
<!-- JS -->
<script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<script>
    const {createApp, reactive, ref} = Vue;

    createApp({
        setup(){
            let storeList = ref([]);
            let count = ref(0); // 바인딩 데이터
            // 음식점 목록 요청  메서드
            const getList=(store_name)=>{
                store_name = (store_name == undefined) ? "" : store_name;
                $.ajax({
                    url: "/food/stores?store_name="+store_name,
                    method: "GET",
                    dataType: "json",
                    success:(res)=>{
                        console.log(res);
                        count.value = res.header.totalRows;
                        storeList.value = res.body;
                    },
                    error:(err)=>{
                        console.log(err);
                    }

                })
            }

            getList();
            return {count, storeList,getList};
        }
    }).mount("#app");
</script>
</body>
</html>
